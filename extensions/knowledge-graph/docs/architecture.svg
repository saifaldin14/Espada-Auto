<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 680" font-family="'Segoe UI',system-ui,-apple-system,sans-serif">
  <defs>
    <linearGradient id="bg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f172a"/>
      <stop offset="100%" style="stop-color:#1e293b"/>
    </linearGradient>
    <filter id="sh" x="-3%" y="-3%" width="106%" height="106%">
      <feDropShadow dx="0" dy="1" stdDeviation="3" flood-color="#000" flood-opacity="0.25"/>
    </filter>
    <marker id="a" markerWidth="7" markerHeight="5" refX="7" refY="2.5" orient="auto">
      <path d="M0,0 L7,2.5 L0,5 Z" fill="#475569"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1000" height="680" rx="12" fill="url(#bg)"/>

  <!-- Title -->
  <text x="500" y="30" text-anchor="middle" fill="#94a3b8" font-size="13" font-weight="600" letter-spacing="2">ARCHITECTURE</text>

  <!-- ═══════════  Layer 1: Plugin Entry Point  ═══════════ -->
  <rect x="40" y="48" width="920" height="42" rx="8" fill="#1e293b" stroke="#334155" stroke-width="1" filter="url(#sh)"/>
  <text x="500" y="67" text-anchor="middle" fill="#cbd5e1" font-size="12" font-weight="700">Plugin Entry Point</text>
  <text x="500" y="82" text-anchor="middle" fill="#64748b" font-size="10">register() · storage factory · engine init · service registration</text>

  <!-- ═══════════  Layer 2: Interface Row  ═══════════ -->
  <!-- CLI -->
  <rect x="40" y="102" width="140" height="54" rx="6" fill="#172554" stroke="#2563eb" stroke-width="1" filter="url(#sh)"/>
  <text x="110" y="124" text-anchor="middle" fill="#93c5fd" font-size="11" font-weight="700">CLI</text>
  <text x="110" y="140" text-anchor="middle" fill="#60a5fa" font-size="9">graph (13) · infra (9)</text>
  <text x="110" y="150" text-anchor="middle" fill="#3b82f6" font-size="8">22 commands</text>

  <!-- MCP Server -->
  <rect x="192" y="102" width="150" height="54" rx="6" fill="#172554" stroke="#2563eb" stroke-width="1" filter="url(#sh)"/>
  <text x="267" y="124" text-anchor="middle" fill="#93c5fd" font-size="11" font-weight="700">MCP Server</text>
  <text x="267" y="140" text-anchor="middle" fill="#60a5fa" font-size="9">31 tools · stdio / SSE</text>

  <!-- REST API -->
  <rect x="354" y="102" width="140" height="54" rx="6" fill="#172554" stroke="#2563eb" stroke-width="1" filter="url(#sh)"/>
  <text x="424" y="124" text-anchor="middle" fill="#93c5fd" font-size="11" font-weight="700">REST API</text>
  <text x="424" y="140" text-anchor="middle" fill="#60a5fa" font-size="9">10 routes · auth · CORS</text>
  <text x="424" y="150" text-anchor="middle" fill="#3b82f6" font-size="8">NDJSON streaming</text>

  <!-- Gateway -->
  <rect x="506" y="102" width="135" height="54" rx="6" fill="#172554" stroke="#2563eb" stroke-width="1" filter="url(#sh)"/>
  <text x="573" y="124" text-anchor="middle" fill="#93c5fd" font-size="11" font-weight="700">Gateway</text>
  <text x="573" y="140" text-anchor="middle" fill="#60a5fa" font-size="9">stats · blast · topology</text>

  <!-- Reports -->
  <rect x="653" y="102" width="140" height="54" rx="6" fill="#172554" stroke="#2563eb" stroke-width="1" filter="url(#sh)"/>
  <text x="723" y="124" text-anchor="middle" fill="#93c5fd" font-size="11" font-weight="700">Reports</text>
  <text x="723" y="140" text-anchor="middle" fill="#60a5fa" font-size="9">MD · HTML · JSON · term</text>

  <!-- OTEL -->
  <rect x="805" y="102" width="155" height="54" rx="6" fill="#172554" stroke="#2563eb" stroke-width="1" filter="url(#sh)"/>
  <text x="882" y="124" text-anchor="middle" fill="#93c5fd" font-size="11" font-weight="700">OTEL</text>
  <text x="882" y="140" text-anchor="middle" fill="#60a5fa" font-size="9">metrics · traces · push/pull</text>

  <!-- Connector line L2→L3 -->
  <line x1="500" y1="156" x2="500" y2="170" stroke="#475569" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- ═══════════  Layer 3: GraphEngine  ═══════════ -->
  <rect x="40" y="170" width="920" height="48" rx="8" fill="#1a1a2e" stroke="#6366f1" stroke-width="1" filter="url(#sh)"/>
  <text x="500" y="192" text-anchor="middle" fill="#a5b4fc" font-size="13" font-weight="700">GraphEngine (17+ methods)</text>
  <text x="500" y="208" text-anchor="middle" fill="#818cf8" font-size="10">sync() · blastRadius() · drift() · cost() · timeline() · topology() · getDependencyChain() · …</text>

  <!-- Connector line L3→L4 -->
  <line x1="500" y1="218" x2="500" y2="232" stroke="#475569" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- ═══════════  Layer 4: Core Systems (4-column grid)  ═══════════ -->
  <!-- Column 1: Adapters -->
  <rect x="40" y="232" width="220" height="170" rx="8" fill="#1c1917" stroke="#78716c" stroke-width="1" filter="url(#sh)"/>
  <text x="150" y="254" text-anchor="middle" fill="#e7e5e4" font-size="12" font-weight="700">Adapters</text>
  <rect x="55" y="264" width="88" height="24" rx="4" fill="#065f46" fill-opacity="0.6" stroke="#10b981" stroke-width="0.7"/>
  <text x="99" y="280" text-anchor="middle" fill="#6ee7b7" font-size="9" font-weight="600">AWS (21)</text>
  <rect x="151" y="264" width="96" height="24" rx="4" fill="#065f46" fill-opacity="0.6" stroke="#10b981" stroke-width="0.7"/>
  <text x="199" y="280" text-anchor="middle" fill="#6ee7b7" font-size="9" font-weight="600">Azure (23)</text>
  <rect x="55" y="294" width="62" height="24" rx="4" fill="#065f46" fill-opacity="0.6" stroke="#10b981" stroke-width="0.7"/>
  <text x="86" y="310" text-anchor="middle" fill="#6ee7b7" font-size="9">GCP</text>
  <rect x="123" y="294" width="55" height="24" rx="4" fill="#065f46" fill-opacity="0.6" stroke="#10b981" stroke-width="0.7"/>
  <text x="150" y="310" text-anchor="middle" fill="#6ee7b7" font-size="9">K8s</text>
  <rect x="184" y="294" width="63" height="24" rx="4" fill="#065f46" fill-opacity="0.6" stroke="#10b981" stroke-width="0.7"/>
  <text x="215" y="310" text-anchor="middle" fill="#6ee7b7" font-size="9">Terraform</text>
  <rect x="55" y="324" width="88" height="24" rx="4" fill="#065f46" fill-opacity="0.4" stroke="#10b981" stroke-width="0.7"/>
  <text x="99" y="340" text-anchor="middle" fill="#6ee7b7" font-size="9">Cross-Cloud</text>
  <text x="150" y="367" text-anchor="middle" fill="#78716c" font-size="9">5 providers · 100+ rules</text>
  <text x="150" y="380" text-anchor="middle" fill="#78716c" font-size="9">incremental + full scan</text>

  <!-- Column 2: Storage -->
  <rect x="272" y="232" width="220" height="170" rx="8" fill="#1c1917" stroke="#78716c" stroke-width="1" filter="url(#sh)"/>
  <text x="382" y="254" text-anchor="middle" fill="#e7e5e4" font-size="12" font-weight="700">Storage</text>
  <rect x="287" y="264" width="88" height="24" rx="4" fill="#7c2d12" fill-opacity="0.5" stroke="#f97316" stroke-width="0.7"/>
  <text x="331" y="280" text-anchor="middle" fill="#fdba74" font-size="9" font-weight="600">SQLite</text>
  <rect x="383" y="264" width="96" height="24" rx="4" fill="#7c2d12" fill-opacity="0.5" stroke="#f97316" stroke-width="0.7"/>
  <text x="431" y="280" text-anchor="middle" fill="#fdba74" font-size="9" font-weight="600">PostgreSQL</text>
  <rect x="287" y="294" width="88" height="24" rx="4" fill="#7c2d12" fill-opacity="0.4" stroke="#f97316" stroke-width="0.7"/>
  <text x="331" y="310" text-anchor="middle" fill="#fdba74" font-size="9">InMemory</text>
  <rect x="383" y="294" width="96" height="24" rx="4" fill="#7c2d12" fill-opacity="0.4" stroke="#f97316" stroke-width="0.7"/>
  <text x="431" y="310" text-anchor="middle" fill="#fdba74" font-size="9">SQLite-Temporal</text>
  <line x1="282" y1="330" x2="482" y2="330" stroke="#44403c" stroke-width="0.5"/>
  <text x="382" y="349" text-anchor="middle" fill="#a8a29e" font-size="10" font-weight="600">Temporal Store</text>
  <text x="382" y="365" text-anchor="middle" fill="#78716c" font-size="9">Snapshots · Diff · Time travel</text>
  <text x="382" y="380" text-anchor="middle" fill="#78716c" font-size="9">WAL · 18 indexes · JSONB · GIN</text>

  <!-- Column 3: Analysis -->
  <rect x="504" y="232" width="220" height="170" rx="8" fill="#1c1917" stroke="#78716c" stroke-width="1" filter="url(#sh)"/>
  <text x="614" y="254" text-anchor="middle" fill="#e7e5e4" font-size="12" font-weight="700">Analysis</text>
  <rect x="519" y="264" width="72" height="22" rx="4" fill="#4c1d95" fill-opacity="0.5" stroke="#8b5cf6" stroke-width="0.7"/>
  <text x="555" y="279" text-anchor="middle" fill="#c4b5fd" font-size="9">Compliance</text>
  <rect x="597" y="264" width="76" height="22" rx="4" fill="#4c1d95" fill-opacity="0.5" stroke="#8b5cf6" stroke-width="0.7"/>
  <text x="635" y="279" text-anchor="middle" fill="#c4b5fd" font-size="9">Remediation</text>
  <rect x="679" y="264" width="32" height="22" rx="4" fill="#4c1d95" fill-opacity="0.5" stroke="#8b5cf6" stroke-width="0.7"/>
  <text x="695" y="279" text-anchor="middle" fill="#c4b5fd" font-size="8">Cost</text>

  <rect x="519" y="292" width="76" height="22" rx="4" fill="#4c1d95" fill-opacity="0.4" stroke="#8b5cf6" stroke-width="0.7"/>
  <text x="557" y="307" text-anchor="middle" fill="#c4b5fd" font-size="9">Supply Chain</text>
  <rect x="601" y="292" width="62" height="22" rx="4" fill="#4c1d95" fill-opacity="0.4" stroke="#8b5cf6" stroke-width="0.7"/>
  <text x="632" y="307" text-anchor="middle" fill="#c4b5fd" font-size="9">Anomaly</text>
  <rect x="669" y="292" width="42" height="22" rx="4" fill="#4c1d95" fill-opacity="0.4" stroke="#8b5cf6" stroke-width="0.7"/>
  <text x="690" y="307" text-anchor="middle" fill="#c4b5fd" font-size="8">Fcst</text>

  <rect x="519" y="320" width="76" height="22" rx="4" fill="#4c1d95" fill-opacity="0.3" stroke="#8b5cf6" stroke-width="0.7"/>
  <text x="557" y="335" text-anchor="middle" fill="#c4b5fd" font-size="9">Deployment</text>
  <rect x="601" y="320" width="62" height="22" rx="4" fill="#4c1d95" fill-opacity="0.3" stroke="#8b5cf6" stroke-width="0.7"/>
  <text x="632" y="335" text-anchor="middle" fill="#c4b5fd" font-size="9">Failover</text>
  <rect x="669" y="320" width="42" height="22" rx="4" fill="#4c1d95" fill-opacity="0.3" stroke="#8b5cf6" stroke-width="0.7"/>
  <text x="690" y="335" text-anchor="middle" fill="#c4b5fd" font-size="8">Recs</text>

  <text x="614" y="367" text-anchor="middle" fill="#78716c" font-size="9">6 frameworks · 5 forecast</text>
  <text x="614" y="380" text-anchor="middle" fill="#78716c" font-size="9">8 anomaly types · RTO/RPO</text>

  <!-- Column 4: Enterprise -->
  <rect x="736" y="232" width="224" height="170" rx="8" fill="#1c1917" stroke="#78716c" stroke-width="1" filter="url(#sh)"/>
  <text x="848" y="254" text-anchor="middle" fill="#e7e5e4" font-size="12" font-weight="700">Enterprise</text>
  <rect x="751" y="264" width="70" height="22" rx="4" fill="#164e63" fill-opacity="0.5" stroke="#22d3ee" stroke-width="0.7"/>
  <text x="786" y="279" text-anchor="middle" fill="#a5f3fc" font-size="9">RBAC</text>
  <rect x="827" y="264" width="85" height="22" rx="4" fill="#164e63" fill-opacity="0.5" stroke="#22d3ee" stroke-width="0.7"/>
  <text x="869" y="279" text-anchor="middle" fill="#a5f3fc" font-size="9">Multi-Tenant</text>

  <rect x="751" y="292" width="80" height="22" rx="4" fill="#164e63" fill-opacity="0.4" stroke="#22d3ee" stroke-width="0.7"/>
  <text x="791" y="307" text-anchor="middle" fill="#a5f3fc" font-size="9">OPA Engine</text>
  <rect x="837" y="292" width="85" height="22" rx="4" fill="#164e63" fill-opacity="0.4" stroke="#22d3ee" stroke-width="0.7"/>
  <text x="879" y="307" text-anchor="middle" fill="#a5f3fc" font-size="9">Governance</text>

  <rect x="751" y="320" width="80" height="22" rx="4" fill="#164e63" fill-opacity="0.3" stroke="#22d3ee" stroke-width="0.7"/>
  <text x="791" y="335" text-anchor="middle" fill="#a5f3fc" font-size="9">Federation</text>
  <rect x="837" y="320" width="85" height="22" rx="4" fill="#164e63" fill-opacity="0.3" stroke="#22d3ee" stroke-width="0.7"/>
  <text x="879" y="335" text-anchor="middle" fill="#a5f3fc" font-size="9">Audit Trails</text>

  <rect x="751" y="348" width="171" height="22" rx="4" fill="#164e63" fill-opacity="0.2" stroke="#22d3ee" stroke-width="0.7"/>
  <text x="836" y="363" text-anchor="middle" fill="#a5f3fc" font-size="9">Monitoring · Alert Rules · Event Sources</text>

  <text x="848" y="393" text-anchor="middle" fill="#78716c" font-size="9">4 roles · 9 perms · 15 OPA conds</text>

  <!-- Connector line L4→L5 -->
  <line x1="500" y1="402" x2="500" y2="418" stroke="#475569" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- ═══════════  Layer 5: IQL + Cache  ═══════════ -->
  <rect x="40" y="418" width="530" height="70" rx="8" fill="#1c1917" stroke="#eab308" stroke-width="1" filter="url(#sh)"/>
  <text x="305" y="441" text-anchor="middle" fill="#fef08a" font-size="12" font-weight="700">IQL Engine</text>
  <text x="305" y="457" text-anchor="middle" fill="#fde047" font-size="10">Lexer (30 kw) → Parser → Executor</text>
  <text x="305" y="473" text-anchor="middle" fill="#a16207" font-size="9">FIND · WHERE · CONNECTED TO · AT · PATH · SUMMARIZE · 5 functions · 9 operators · aggregations</text>

  <rect x="582" y="418" width="378" height="70" rx="8" fill="#1c1917" stroke="#78716c" stroke-width="1" filter="url(#sh)"/>
  <text x="771" y="441" text-anchor="middle" fill="#e7e5e4" font-size="12" font-weight="700">Cache (LRU + TTL)</text>
  <text x="771" y="457" text-anchor="middle" fill="#a8a29e" font-size="10">Category invalidation · Hit-rate stats</text>
  <text x="771" y="473" text-anchor="middle" fill="#78716c" font-size="9">Configurable max size · Per-category TTL</text>

  <!-- Connector line L5→L6 -->
  <line x1="500" y1="488" x2="500" y2="502" stroke="#475569" stroke-width="1" stroke-dasharray="4,3"/>

  <!-- ═══════════  Layer 6: Visualization + NL  ═══════════ -->
  <rect x="40" y="502" width="920" height="55" rx="8" fill="#1c1917" stroke="#78716c" stroke-width="1" filter="url(#sh)"/>
  <text x="270" y="525" text-anchor="middle" fill="#e7e5e4" font-size="11" font-weight="700">Visualization</text>
  <text x="270" y="542" text-anchor="middle" fill="#78716c" font-size="9">Cytoscape · D3 · 5 layouts · 30+ colors</text>

  <line x1="490" y1="512" x2="490" y2="548" stroke="#44403c" stroke-width="0.5"/>

  <text x="620" y="525" text-anchor="middle" fill="#e7e5e4" font-size="11" font-weight="700">NL Translator</text>
  <text x="620" y="542" text-anchor="middle" fill="#78716c" font-size="9">50+ terms → IQL · LLM fallback</text>

  <line x1="760" y1="512" x2="760" y2="548" stroke="#44403c" stroke-width="0.5"/>

  <text x="870" y="525" text-anchor="middle" fill="#e7e5e4" font-size="11" font-weight="700">Policy Authoring</text>
  <text x="870" y="542" text-anchor="middle" fill="#78716c" font-size="9">10 templates · OPA integration</text>

  <!-- Bottom stats -->
  <rect x="40" y="570" width="920" height="28" rx="6" fill="#0f172a" stroke="#1e293b" stroke-width="1"/>
  <text x="110" y="589" text-anchor="middle" fill="#60a5fa" font-size="9" font-weight="600">30,000+ LOC</text>
  <line x1="175" y1="576" x2="175" y2="592" stroke="#334155" stroke-width="0.5"/>
  <text x="250" y="589" text-anchor="middle" fill="#f97316" font-size="9" font-weight="600">56+ source files</text>
  <line x1="330" y1="576" x2="330" y2="592" stroke="#334155" stroke-width="0.5"/>
  <text x="405" y="589" text-anchor="middle" fill="#8b5cf6" font-size="9" font-weight="600">44 adapter modules</text>
  <line x1="490" y1="576" x2="490" y2="592" stroke="#334155" stroke-width="0.5"/>
  <text x="560" y="589" text-anchor="middle" fill="#22d3ee" font-size="9" font-weight="600">150+ functions</text>
  <line x1="630" y1="576" x2="630" y2="592" stroke="#334155" stroke-width="0.5"/>
  <text x="700" y="589" text-anchor="middle" fill="#10b981" font-size="9" font-weight="600">80+ types</text>
  <line x1="755" y1="576" x2="755" y2="592" stroke="#334155" stroke-width="0.5"/>
  <text x="830" y="589" text-anchor="middle" fill="#e879f9" font-size="9" font-weight="600">20+ classes</text>
  <line x1="895" y1="576" x2="895" y2="592" stroke="#334155" stroke-width="0.5"/>
  <text x="940" y="589" text-anchor="middle" fill="#fbbf24" font-size="9" font-weight="600">MIT</text>
</svg>
